<%= render 'shared/errors', obj: @image %>

<div class="well col-xs-10 col-xs-offset-1">
  <table width="100%" border="0" cellspacing=5 cellpadding=25>
    <tr valign="center">  
      <%# mcount = @article.images.count %>
      <% mcount = 6 %>
      <% @article.images.each do |t| %>
        <td align="center"><%= image_tag t.picture.url, size: "280x190" %><br><br>
        </td>
        <% mcount = mcount - 1 %>
        <% if mcount == 3 %>
           <tr>
        <% end %>
      <% end %>

      <% while mcount > 0 %>
        <% if mcount == 3 %>
           <tr>
        <% end %>
        <td><%= image_tag("camera.gif") %><%#= render 'formaddimage' %></td>
        <% mcount = mcount - 1 %>        
      <%end %>
    </tr>
  </table> <br>
  
  <% if @article.images.count < 6 %>
    <%= form_for @image, :html => { multipart: true, :class => "form-horizontal image" } do |f| %>
      <% if @image.errors.any? %>
        <div id="error_expl" class="panel panel-danger">
          <div class="panel-heading">
            <h3 class="panel-title"><%= pluralize(@image.errors.count, "error") %> prohibited this image from being saved:</h3>
          </div>
          <div class="panel-body">
            <ul>
              <% @image.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        </div>
      <% end %>
      <%= f.hidden_field :name, :value => "test hide" %>
      <%= f.file_field :picture, accept: 'image/jpeg,image/gif,image/png',  :onchange => "this.form.submit()" %>
    <% end %>
  <% end %>
  
</div>


<script type="text/javascript">
  $('#image_picture').bind('change', function() {
  var size_in_megabytes = this.files[0].size/1024/1024;
  if (size_in_megabytes > 5) {
    alert('Maximum file size is 5MB.');
}
});
</script>